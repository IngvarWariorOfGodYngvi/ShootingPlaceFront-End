{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[21],{\"27f3\":function(t,e,s){\"use strict\";s.r(e);var i=function(){var t=this,e=t._self._c;return t.open1?e(\"div\",{staticStyle:{\"min-width\":\"60%\"}},[e(\"div\",{staticClass:\"bg-dark text-positive\"},[e(\"div\",{staticClass:\"row\"},[e(\"q-select\",{staticClass:\"col\",attrs:{label:\"Wybierz osobę z Klubu\",\"popup-content-class\":\"bg-dark text-positive\",\"option-value\":t=>\"\"!==t?Object(t.secondName+\" \"+t.firstName+\" \"+t.legitimationNumber).toString():\"\",\"option-label\":t=>\"\"!==t?Object(t.secondName+\" \"+t.firstName+\" \"+t.legitimationNumber).toString():\"\",\"emit-value\":\"\",\"map-options\":\"\",\"options-dense\":\"\",color:\"positive\",\"input-class\":\"text-positive\",\"label-color\":\"positive\",\"fill-input\":\"\",filled:\"\",dense:\"\",\"use-input\":\"\",\"hide-selected\":\"\",\"input-debounce\":\"0\",options:t.options},on:{input:function(e){t.otherName=\"0 0\"},filter:t.filterFn},scopedSlots:t._u([{key:\"option\",fn:function(s){return[e(\"q-item\",t._g(t._b({staticClass:\"rounded bg-dark text-positive\",staticStyle:{padding:\"0\",margin:\"0\"},attrs:{dense:\"\"}},\"q-item\",s.itemProps,!1),s.itemEvents),[e(\"q-item-section\",{class:s.opt.active?\"\":\"bg-warning rounded\",staticStyle:{padding:\"0.5em\",margin:\"0\"},attrs:{dense:\"\"},on:{click:function(e){t.otherName=\"0 0\",t.memberName=s.opt.secondName+\" \"+s.opt.firstName+\" \"+s.opt.legitimationNumber}}},[e(\"div\",[t._v(t._s(s.opt.secondName)+\" \"+t._s(s.opt.firstName)+\"\\n                  \"+t._s(s.opt.legitimationNumber)+\" \"+t._s(s.opt.adult?\"Ogólna\":\"Młodzież\")+\" \"+t._s(s.opt.active?\"\":\" - BRAK SKŁADEK\")+\"\\n                \")])])],1)]}},{key:\"no-option\",fn:function(){return[e(\"q-item\",[e(\"q-item-section\",{staticClass:\"text-grey\"},[t._v(\"\\n                Brak wyników\\n              \")])],1)]},proxy:!0}],null,!1,3287776820),model:{value:t.memberName,callback:function(e){t.memberName=e},expression:\"memberName\"}}),e(\"q-select\",{staticClass:\"col\",attrs:{\"options-dense\":\"\",dense:\"\",filled:\"\",\"use-input\":\"\",\"hide-selected\":\"\",\"fill-input\":\"\",\"input-debounce\":\"0\",color:\"positive\",\"input-class\":\"text-positive\",\"label-color\":\"positive\",\"popup-content-class\":\"bg-dark text-positive\",options:t.options1,label:\"Dodaj osobę spoza klubu\"},on:{\"popup-show\":function(e){return t.getOther()},\"popup-hide\":function(e){return t.getOther()},input:function(e){t.memberName=\"0 0\"},filter:t.filterOther},scopedSlots:t._u([{key:\"no-option\",fn:function(){return[e(\"div\",{staticClass:\"bg-dark text-center text-bold text-positive\"},[e(\"div\",{staticClass:\"q-pa-md bg-dark text-center text-bold text-positive\"},[t._v(\"Brak wyników - możesz dodać nową\\n                osobę\\n              \")]),e(\"AddNewOtherPerson\")],1)]},proxy:!0}],null,!1,1125606122),model:{value:t.otherName,callback:function(e){t.otherName=e},expression:\"otherName\"}})],1),t._l(t.calibers,(function(s,i){return e(\"q-item\",{key:i,attrs:{dense:\"\",val:s.uuid}},[e(\"div\",{staticClass:\"text-positive text-center col\",staticStyle:{display:\"flex\",\"justify-content\":\"center\",\"align-content\":\"center\",\"flex-direction\":\"column\"}},[t._v(t._s(s.name))]),e(\"q-input\",{staticClass:\"col\",attrs:{color:\"positive\",\"label-color\":\"positive\",\"input-class\":\"text-positive\",dense:\"\",filled:\"\",label:\"max: \"+s.quantity,onkeypress:\"return (event.charCode > 44 && event.charCode < 58)\",type:\"number\",max:s.quantity},on:{focus:function(t){s.counter.startsWith(\"0\")?s.counter=\"\":s.counter=s.counter},input:function(e){\"\"===s.counter?s.counter=\"0\":s.counter=s.counter,t.onInput(s,s.counter)},keypress:function(e){return!e.type.indexOf(\"key\")&&t._k(e.keyCode,\"enter\",13,e.key,\"Enter\")?null:t.simulateProgress(0)}},model:{value:s.counter,callback:function(e){t.$set(s,\"counter\",e)},expression:\"item.counter\"}}),e(\"div\",{staticClass:\"col text-center\",staticStyle:{display:\"flex\",\"justify-content\":\"center\",\"align-content\":\"center\",\"flex-direction\":\"column\"}},[t._v(\" * \"+t._s(t.viewCurrency(s.unitPrice))+\" = \"+t._s(t.viewCurrency(s.counter*s.unitPrice))+\" \")]),e(\"div\",{staticClass:\"col text-center\",staticStyle:{display:\"flex\",\"justify-content\":\"center\",\"align-content\":\"center\",\"flex-direction\":\"column\"}},[t._v(\" * \"+t._s(t.viewCurrency(s.unitPriceForNotMember))+\" = \"+t._s(t.viewCurrency(s.counter*s.unitPriceForNotMember)))])],1)})),e(\"q-item\",{attrs:{dense:\"\"}},[e(\"div\",{staticClass:\"col\"}),e(\"q-input\",{staticClass:\"col-3\",attrs:{type:\"number\",min:\"-23\",max:\"100\",dense:\"\",filled:\"\",label:\"rabat w %\",onkeypress:\"return (event.charCode > 47 && event.charCode < 58)\",\"label-color\":\"positive\",\"input-class\":\"text-positive\",suffix:\"%\"},on:{focus:function(e){String(t.discount).startsWith(\"0\")?t.discount=\"\":t.discount=t.discount}},model:{value:t.discount,callback:function(e){t.discount=e},expression:\"discount\"}}),e(\"div\",{staticClass:\"col-3 text-center\"},[e(\"div\",[t._v(\"dla klubowicza: \"),e(\"div\",{staticClass:\"text-bold\",staticStyle:{border:\"solid 3px black\"}},[t._v(t._s(t.viewCurrency(t.sum(t.memberCostSum))))])]),e(\"div\",[t._v(\"po rabacie: \"),e(\"div\",{staticClass:\"text-bold text-primary\",staticStyle:{border:\"solid 3px black\"}},[t._v(t._s(t.viewCurrency(t.sum(t.memberCostSum)-t.sum(t.memberCostSum)/100*t.discount)))])])]),e(\"div\",{staticClass:\"col-3 text-center\"},[e(\"div\",[t._v(\"pozostali: \"),e(\"div\",{staticClass:\"text-bold\",staticStyle:{border:\"solid 3px black\"}},[t._v(t._s(t.viewCurrency(t.sum(t.notMemberCostSum))))])]),e(\"div\",[t._v(\"po rabacie: \"),e(\"div\",{staticClass:\"text-bold text-primary\",staticStyle:{border:\"solid 3px black\"}},[t._v(t._s(t.viewCurrency(t.sum(t.notMemberCostSum)-t.sum(t.notMemberCostSum)/100*t.discount)))])])])],1),e(\"div\",{staticClass:\"col\"},[e(\"q-card-actions\",{staticClass:\"row\",attrs:{align:\"right\"}},[e(\"q-item\",[e(\"q-btn\",{directives:[{name:\"close-popup\",rawName:\"v-close-popup\"}],staticClass:\"full-width col\",attrs:{color:\"primary\",icon:\"close\"},on:{click:function(e){t.memberName=\"\",t.otherName=\"\"}}})],1),e(\"q-item\",[e(\"q-btn\",{staticClass:\"full-width col\",attrs:{color:\"primary\",loading:t.loading[0],icon:\"done\",disable:t.dis||\"\"===t.memberName||\"\"===t.otherName},on:{click:function(e){t.dis=!0,t.simulateProgress(0)}}})],1)],1)],1)],2),e(\"q-dialog\",{attrs:{position:\"top\"},model:{value:t.success,callback:function(e){t.success=e},expression:\"success\"}},[e(\"q-card\",[e(\"q-card-section\",[e(\"div\",{staticClass:\"text-h6\"},[t._v(t._s(t.message))])])],1)],1),e(\"q-dialog\",{attrs:{position:\"standard\"},model:{value:t.failure,callback:function(e){t.failure=e},expression:\"failure\"}},[e(\"q-card\",{staticClass:\"bg-warning\"},[e(\"q-card-section\",[e(\"div\",{staticClass:\"text-h6\"},[t._v(t._s(t.message))])])],1)],1)],1):t._e()},o=[],n=(s(\"14d9\"),s(\"2b0e\")),r=s(\"3dfd\"),a=s(\"a8bc\"),c=s(\"d6c6\"),l={props:{open:{type:Boolean,required:!0,default:!1}},components:{AddNewOtherPerson:Object(a[\"a\"])({componentFactory:()=>Promise.all([s.e(0),s.e(1)]).then(s.bind(null,\"ff2c\")),loading:c[\"a\"]})},created(){this.getListCalibers(),this.getMembersNames(),this.getOther()},setup(){const t=Object(n[\"ref\"])([!1]),e=Object(n[\"ref\"])(!1);function s(e){t.value[e]=!0,this.addMemberAndAmmoToCaliber(this.mapCalibers(this.calibers)),setTimeout((()=>{t.value[e]=!1}),0)}function i(e,s,i){t.value[e]=!0,this.addGunToList(s,i),setTimeout((()=>{t.value[e]=!1}),0)}return{loading:t,progress:e,simulateProgress:s,simulateProgressGun:i}},data(){return{dis:!1,memberName:\"\",otherName:\"\",open1:open,calibers:[],options:[],options1:[],filters:[],filtersOther:[],counter:\"\",discount:0,memberCostSum:[],notMemberCostSum:[],map:null,message:null,success:!1,failure:!1,local:r[\"default\"].host}},methods:{sum(t){const e=t.reduce((function(t,e){return t+e}),0);return e},getMembersNames(){fetch(\"http://\"+this.local+\"/member/getAllNames\",{method:\"GET\"}).then((t=>t.json())).then((t=>{this.filters=t}))},getOther(){fetch(\"http://\"+this.local+\"/other/\",{method:\"GET\"}).then((t=>t.json())).then((t=>{this.filtersOther=t}))},getListCalibers(){fetch(`http://${this.local}/armory/calibers`,{method:\"GET\"}).then((t=>{t.json().then((t=>{let e=[];if(this.calibers=[],t.length>0){e=t.slice(0,t.length);for(let t=0;t<e.length;t++)this.calibers.push({uuid:e[t].uuid,counter:\"0\",unitPrice:e[t].unitPrice,unitPriceForNotMember:e[t].unitPriceForNotMember,name:e[t].name,quantity:e[t].quantity})}}))}))},onInput(t,e){const s=this.calibers.find((function(e){return e.uuid===t.uuid}));s.counter=e;const i=this.calibers.findIndex((function(e){return e.uuid===t.uuid}));s.counter>=0&&(this.memberCostSum[i]=s.unitPrice*s.counter,this.notMemberCostSum[i]=s.unitPriceForNotMember*s.counter),this.calibers[i]=s,this.counter=\"\"},viewCurrency(t){void 0===t&&(t=\"0\");const e=new Intl.NumberFormat(\"pl-PL\",{style:\"currency\",currency:\"PLN\"}),s=e.format(t);return s},mapCalibers(t){const e=new Map;for(let s=0;s<t.length;s++)\"0\"!==t[s].counter&&\"\"!==t[s].counter&&e.set(t[s].uuid,Number(t[s].counter));return e},addMemberAndAmmoToCaliber(t){const e=this.memberName.split(\" \"),s=e.length,i=e[s-1],o=this.otherName.split(\" \"),n=o.length,r=o[n-1];fetch(`http://${this.local}/ammoEvidence/listOfAmmo?legitimationNumber=${i}&otherID=${r}`,{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(Object.fromEntries(t))}).then((t=>{200===t.status?t.text().then((t=>{this.message=t,this.success=!0,this.dis=!1,this.getListCalibers(),this.memberCostSum=[],this.notMemberCostSum=[],this.$emit(\"addMemberAndAmmoToCaliber\"),this.autoClose()})):t.text().then((t=>{this.message=t,this.failure=!0,this.dis=!1,this.autoClose()}))})).catch((()=>{this.message=\"coś jest nie tak\",this.failure=!0,this.dis=!1,this.autoClose()}))},filterFn(t,e){e(\"\"!==t?()=>{const e=t.toLowerCase();this.options=this.filters.filter((t=>t.name.toLowerCase().indexOf(e)>-1))}:()=>{const e=t.toLowerCase();this.options=this.filters.filter((t=>t.name.toLowerCase().indexOf(e)>-1))})},filterOther(t,e){e(\"\"!==t?()=>{const e=t.toLowerCase();this.options1=this.filtersOther.filter((t=>t.toLowerCase().indexOf(e)>-1))}:()=>{const e=t.toLowerCase();this.options1=this.filtersOther.filter((t=>t.toLowerCase().indexOf(e)>-1))})},autoClose(){setTimeout((()=>{this.success=!1,this.failure=!1,this.message=null,document.getElementById(\"1\").close()}),2e3)}}},u=l,d=s(\"2877\"),m=s(\"ddd8\"),p=s(\"66e5\"),b=s(\"4074\"),h=s(\"27f9\"),f=s(\"4b7e\"),v=s(\"9c40\"),C=s(\"24e8\"),g=s(\"f09f\"),y=s(\"a370\"),x=s(\"7f67\"),N=s(\"eebe\"),w=s.n(N),_=Object(d[\"a\"])(u,i,o,!1,null,null,null);e[\"default\"]=_.exports;w()(_,\"components\",{QSelect:m[\"a\"],QItem:p[\"a\"],QItemSection:b[\"a\"],QInput:h[\"a\"],QCardActions:f[\"a\"],QBtn:v[\"a\"],QDialog:C[\"a\"],QCard:g[\"a\"],QCardSection:y[\"a\"]}),w()(_,\"directives\",{ClosePopup:x[\"a\"]})}}]);","name":"js/21.c28b6822.js","input":"(window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || []).push([[21],{\n\n/***/ \"27f3\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n// ESM COMPAT FLAG\n__webpack_require__.r(__webpack_exports__);\n\n// CONCATENATED MODULE: ./node_modules/@quasar/app/lib/webpack/loader.transform-quasar-imports.js!./node_modules/babel-loader/lib??ref--2-0!./node_modules/vue-loader/lib/loaders/templateLoader.js??ref--7!./node_modules/@quasar/app/lib/webpack/loader.auto-import-client.js?kebab!./node_modules/vue-loader/lib??vue-loader-options!./src/components/ammoList/AddAmmunition.vue?vue&type=template&id=0924d0c2&\nvar render = function render() {\n  var _vm = this,\n    _c = _vm._self._c;\n  return _vm.open1 ? _c('div', {\n    staticStyle: {\n      \"min-width\": \"60%\"\n    }\n  }, [_c('div', {\n    staticClass: \"bg-dark text-positive\"\n  }, [_c('div', {\n    staticClass: \"row\"\n  }, [_c('q-select', {\n    staticClass: \"col\",\n    attrs: {\n      \"label\": \"Wybierz osobę z Klubu\",\n      \"popup-content-class\": \"bg-dark text-positive\",\n      \"option-value\": opt => opt !== '' ? Object(opt.secondName + ' ' + opt.firstName + ' ' + opt.legitimationNumber).toString() : '',\n      \"option-label\": opt => opt !== '' ? Object(opt.secondName + ' ' + opt.firstName + ' ' + opt.legitimationNumber).toString() : '',\n      \"emit-value\": \"\",\n      \"map-options\": \"\",\n      \"options-dense\": \"\",\n      \"color\": \"positive\",\n      \"input-class\": \"text-positive\",\n      \"label-color\": \"positive\",\n      \"fill-input\": \"\",\n      \"filled\": \"\",\n      \"dense\": \"\",\n      \"use-input\": \"\",\n      \"hide-selected\": \"\",\n      \"input-debounce\": \"0\",\n      \"options\": _vm.options\n    },\n    on: {\n      \"input\": function ($event) {\n        _vm.otherName = '0 0';\n      },\n      \"filter\": _vm.filterFn\n    },\n    scopedSlots: _vm._u([{\n      key: \"option\",\n      fn: function (option) {\n        return [_c('q-item', _vm._g(_vm._b({\n          staticClass: \"rounded bg-dark text-positive\",\n          staticStyle: {\n            \"padding\": \"0\",\n            \"margin\": \"0\"\n          },\n          attrs: {\n            \"dense\": \"\"\n          }\n        }, 'q-item', option.itemProps, false), option.itemEvents), [_c('q-item-section', {\n          class: option.opt.active ? '' : 'bg-warning rounded',\n          staticStyle: {\n            \"padding\": \"0.5em\",\n            \"margin\": \"0\"\n          },\n          attrs: {\n            \"dense\": \"\"\n          },\n          on: {\n            \"click\": function ($event) {\n              _vm.otherName = '0 0';\n              _vm.memberName = option.opt.secondName + ' ' + option.opt.firstName + ' ' + option.opt.legitimationNumber;\n            }\n          }\n        }, [_c('div', [_vm._v(_vm._s(option.opt.secondName) + \" \" + _vm._s(option.opt.firstName) + \"\\n                  \" + _vm._s(option.opt.legitimationNumber) + \" \" + _vm._s(option.opt.adult ? 'Ogólna' : 'Młodzież') + \" \" + _vm._s(option.opt.active ? '' : ' - BRAK SKŁADEK') + \"\\n                \")])])], 1)];\n      }\n    }, {\n      key: \"no-option\",\n      fn: function () {\n        return [_c('q-item', [_c('q-item-section', {\n          staticClass: \"text-grey\"\n        }, [_vm._v(\"\\n                Brak wyników\\n              \")])], 1)];\n      },\n      proxy: true\n    }], null, false, 3287776820),\n    model: {\n      value: _vm.memberName,\n      callback: function ($$v) {\n        _vm.memberName = $$v;\n      },\n      expression: \"memberName\"\n    }\n  }), _c('q-select', {\n    staticClass: \"col\",\n    attrs: {\n      \"options-dense\": \"\",\n      \"dense\": \"\",\n      \"filled\": \"\",\n      \"use-input\": \"\",\n      \"hide-selected\": \"\",\n      \"fill-input\": \"\",\n      \"input-debounce\": \"0\",\n      \"color\": \"positive\",\n      \"input-class\": \"text-positive\",\n      \"label-color\": \"positive\",\n      \"popup-content-class\": \"bg-dark text-positive\",\n      \"options\": _vm.options1,\n      \"label\": \"Dodaj osobę spoza klubu\"\n    },\n    on: {\n      \"popup-show\": function ($event) {\n        return _vm.getOther();\n      },\n      \"popup-hide\": function ($event) {\n        return _vm.getOther();\n      },\n      \"input\": function ($event) {\n        _vm.memberName = '0 0';\n      },\n      \"filter\": _vm.filterOther\n    },\n    scopedSlots: _vm._u([{\n      key: \"no-option\",\n      fn: function () {\n        return [_c('div', {\n          staticClass: \"bg-dark text-center text-bold text-positive\"\n        }, [_c('div', {\n          staticClass: \"q-pa-md bg-dark text-center text-bold text-positive\"\n        }, [_vm._v(\"Brak wyników - możesz dodać nową\\n                osobę\\n              \")]), _c('AddNewOtherPerson')], 1)];\n      },\n      proxy: true\n    }], null, false, 1125606122),\n    model: {\n      value: _vm.otherName,\n      callback: function ($$v) {\n        _vm.otherName = $$v;\n      },\n      expression: \"otherName\"\n    }\n  })], 1), _vm._l(_vm.calibers, function (item, uuid) {\n    return _c('q-item', {\n      key: uuid,\n      attrs: {\n        \"dense\": \"\",\n        \"val\": item.uuid\n      }\n    }, [_c('div', {\n      staticClass: \"text-positive text-center col\",\n      staticStyle: {\n        \"display\": \"flex\",\n        \"justify-content\": \"center\",\n        \"align-content\": \"center\",\n        \"flex-direction\": \"column\"\n      }\n    }, [_vm._v(_vm._s(item.name))]), _c('q-input', {\n      staticClass: \"col\",\n      attrs: {\n        \"color\": \"positive\",\n        \"label-color\": \"positive\",\n        \"input-class\": \"text-positive\",\n        \"dense\": \"\",\n        \"filled\": \"\",\n        \"label\": 'max: ' + item.quantity,\n        \"onkeypress\": \"return (event.charCode > 44 && event.charCode < 58)\",\n        \"type\": \"number\",\n        \"max\": item.quantity\n      },\n      on: {\n        \"focus\": function ($event) {\n          item.counter.startsWith('0') ? item.counter = '' : item.counter = item.counter;\n        },\n        \"input\": function ($event) {\n          item.counter === '' ? item.counter = '0' : item.counter = item.counter;\n          _vm.onInput(item, item.counter);\n        },\n        \"keypress\": function ($event) {\n          if (!$event.type.indexOf('key') && _vm._k($event.keyCode, \"enter\", 13, $event.key, \"Enter\")) return null;\n          return _vm.simulateProgress(0);\n        }\n      },\n      model: {\n        value: item.counter,\n        callback: function ($$v) {\n          _vm.$set(item, \"counter\", $$v);\n        },\n        expression: \"item.counter\"\n      }\n    }), _c('div', {\n      staticClass: \"col text-center\",\n      staticStyle: {\n        \"display\": \"flex\",\n        \"justify-content\": \"center\",\n        \"align-content\": \"center\",\n        \"flex-direction\": \"column\"\n      }\n    }, [_vm._v(\" * \" + _vm._s(_vm.viewCurrency(item.unitPrice)) + \" = \" + _vm._s(_vm.viewCurrency(item.counter * item.unitPrice)) + \" \")]), _c('div', {\n      staticClass: \"col text-center\",\n      staticStyle: {\n        \"display\": \"flex\",\n        \"justify-content\": \"center\",\n        \"align-content\": \"center\",\n        \"flex-direction\": \"column\"\n      }\n    }, [_vm._v(\" * \" + _vm._s(_vm.viewCurrency(item.unitPriceForNotMember)) + \" = \" + _vm._s(_vm.viewCurrency(item.counter * item.unitPriceForNotMember)))])], 1);\n  }), _c('q-item', {\n    attrs: {\n      \"dense\": \"\"\n    }\n  }, [_c('div', {\n    staticClass: \"col\"\n  }), _c('q-input', {\n    staticClass: \"col-3\",\n    attrs: {\n      \"type\": \"number\",\n      \"min\": \"-23\",\n      \"max\": \"100\",\n      \"dense\": \"\",\n      \"filled\": \"\",\n      \"label\": \"rabat w %\",\n      \"onkeypress\": \"return (event.charCode > 47 && event.charCode < 58)\",\n      \"label-color\": \"positive\",\n      \"input-class\": \"text-positive\",\n      \"suffix\": \"%\"\n    },\n    on: {\n      \"focus\": function ($event) {\n        String(_vm.discount).startsWith('0') ? _vm.discount = '' : _vm.discount = _vm.discount;\n      }\n    },\n    model: {\n      value: _vm.discount,\n      callback: function ($$v) {\n        _vm.discount = $$v;\n      },\n      expression: \"discount\"\n    }\n  }), _c('div', {\n    staticClass: \"col-3 text-center\"\n  }, [_c('div', [_vm._v(\"dla klubowicza: \"), _c('div', {\n    staticClass: \"text-bold\",\n    staticStyle: {\n      \"border\": \"solid 3px black\"\n    }\n  }, [_vm._v(_vm._s(_vm.viewCurrency(_vm.sum(_vm.memberCostSum))))])]), _c('div', [_vm._v(\"po rabacie: \"), _c('div', {\n    staticClass: \"text-bold text-primary\",\n    staticStyle: {\n      \"border\": \"solid 3px black\"\n    }\n  }, [_vm._v(_vm._s(_vm.viewCurrency(_vm.sum(_vm.memberCostSum) - _vm.sum(_vm.memberCostSum) / 100 * _vm.discount)))])])]), _c('div', {\n    staticClass: \"col-3 text-center\"\n  }, [_c('div', [_vm._v(\"pozostali: \"), _c('div', {\n    staticClass: \"text-bold\",\n    staticStyle: {\n      \"border\": \"solid 3px black\"\n    }\n  }, [_vm._v(_vm._s(_vm.viewCurrency(_vm.sum(_vm.notMemberCostSum))))])]), _c('div', [_vm._v(\"po rabacie: \"), _c('div', {\n    staticClass: \"text-bold text-primary\",\n    staticStyle: {\n      \"border\": \"solid 3px black\"\n    }\n  }, [_vm._v(_vm._s(_vm.viewCurrency(_vm.sum(_vm.notMemberCostSum) - _vm.sum(_vm.notMemberCostSum) / 100 * _vm.discount)))])])])], 1), _c('div', {\n    staticClass: \"col\"\n  }, [_c('q-card-actions', {\n    staticClass: \"row\",\n    attrs: {\n      \"align\": \"right\"\n    }\n  }, [_c('q-item', [_c('q-btn', {\n    directives: [{\n      name: \"close-popup\",\n      rawName: \"v-close-popup\"\n    }],\n    staticClass: \"full-width col\",\n    attrs: {\n      \"color\": \"primary\",\n      \"icon\": \"close\"\n    },\n    on: {\n      \"click\": function ($event) {\n        _vm.memberName = '';\n        _vm.otherName = '';\n      }\n    }\n  })], 1), _c('q-item', [_c('q-btn', {\n    staticClass: \"full-width col\",\n    attrs: {\n      \"color\": \"primary\",\n      \"loading\": _vm.loading[0],\n      \"icon\": \"done\",\n      \"disable\": _vm.dis || _vm.memberName === '' || _vm.otherName === ''\n    },\n    on: {\n      \"click\": function ($event) {\n        _vm.dis = true;\n        _vm.simulateProgress(0);\n      }\n    }\n  })], 1)], 1)], 1)], 2), _c('q-dialog', {\n    attrs: {\n      \"position\": \"top\"\n    },\n    model: {\n      value: _vm.success,\n      callback: function ($$v) {\n        _vm.success = $$v;\n      },\n      expression: \"success\"\n    }\n  }, [_c('q-card', [_c('q-card-section', [_c('div', {\n    staticClass: \"text-h6\"\n  }, [_vm._v(_vm._s(_vm.message))])])], 1)], 1), _c('q-dialog', {\n    attrs: {\n      \"position\": \"standard\"\n    },\n    model: {\n      value: _vm.failure,\n      callback: function ($$v) {\n        _vm.failure = $$v;\n      },\n      expression: \"failure\"\n    }\n  }, [_c('q-card', {\n    staticClass: \"bg-warning\"\n  }, [_c('q-card-section', [_c('div', {\n    staticClass: \"text-h6\"\n  }, [_vm._v(_vm._s(_vm.message))])])], 1)], 1)], 1) : _vm._e();\n};\nvar staticRenderFns = [];\n\n// CONCATENATED MODULE: ./src/components/ammoList/AddAmmunition.vue?vue&type=template&id=0924d0c2&\n\n// EXTERNAL MODULE: ./node_modules/core-js/modules/es.array.push.js\nvar es_array_push = __webpack_require__(\"14d9\");\n\n// EXTERNAL MODULE: ./node_modules/vue/dist/vue.runtime.esm.js\nvar vue_runtime_esm = __webpack_require__(\"2b0e\");\n\n// EXTERNAL MODULE: ./src/App.vue + 4 modules\nvar App = __webpack_require__(\"3dfd\");\n\n// EXTERNAL MODULE: ./src/utils/lazyLoadComponent.js\nvar lazyLoadComponent = __webpack_require__(\"a8bc\");\n\n// EXTERNAL MODULE: ./src/utils/SkeletonBox.vue + 4 modules\nvar SkeletonBox = __webpack_require__(\"d6c6\");\n\n// CONCATENATED MODULE: ./node_modules/@quasar/app/lib/webpack/loader.transform-quasar-imports.js!./node_modules/babel-loader/lib??ref--2-0!./node_modules/@quasar/app/lib/webpack/loader.auto-import-client.js?kebab!./node_modules/vue-loader/lib??vue-loader-options!./src/components/ammoList/AddAmmunition.vue?vue&type=script&lang=js&\n\n\n\n\n\n/* harmony default export */ var AddAmmunitionvue_type_script_lang_js_ = ({\n  props: {\n    open: {\n      type: Boolean,\n      required: true,\n      default: false\n    }\n  },\n  components: {\n    AddNewOtherPerson: Object(lazyLoadComponent[\"a\" /* default */])({\n      componentFactory: () => Promise.all(/* import() */[__webpack_require__.e(0), __webpack_require__.e(1)]).then(__webpack_require__.bind(null, \"ff2c\")),\n      loading: SkeletonBox[\"a\" /* default */]\n    })\n  },\n  created() {\n    this.getListCalibers();\n    this.getMembersNames();\n    this.getOther();\n  },\n  setup() {\n    const loading = Object(vue_runtime_esm[\"ref\"])([false]);\n    const progress = Object(vue_runtime_esm[\"ref\"])(false);\n    function simulateProgress(number) {\n      loading.value[number] = true;\n      this.addMemberAndAmmoToCaliber(this.mapCalibers(this.calibers));\n      setTimeout(() => {\n        loading.value[number] = false;\n      }, 0);\n    }\n    function simulateProgressGun(number, evidenceUUID, barcode) {\n      loading.value[number] = true;\n      this.addGunToList(evidenceUUID, barcode);\n      setTimeout(() => {\n        loading.value[number] = false;\n      }, 0);\n    }\n    return {\n      loading,\n      progress,\n      simulateProgress,\n      simulateProgressGun\n    };\n  },\n  data() {\n    return {\n      dis: false,\n      memberName: '',\n      otherName: '',\n      open1: open,\n      calibers: [],\n      options: [],\n      options1: [],\n      filters: [],\n      filtersOther: [],\n      counter: '',\n      discount: 0,\n      memberCostSum: [],\n      notMemberCostSum: [],\n      map: null,\n      message: null,\n      success: false,\n      failure: false,\n      local: App[\"default\"].host\n    };\n  },\n  methods: {\n    sum(arr) {\n      const sum = arr.reduce(function (a, b) {\n        return a + b;\n      }, 0);\n      return sum;\n    },\n    getMembersNames() {\n      fetch('http://' + this.local + '/member/getAllNames', {\n        method: 'GET'\n      }).then(response => response.json()).then(response => {\n        this.filters = response;\n      });\n    },\n    getOther() {\n      fetch('http://' + this.local + '/other/', {\n        method: 'GET'\n      }).then(response => response.json()).then(response => {\n        this.filtersOther = response;\n      });\n    },\n    getListCalibers() {\n      fetch(`http://${this.local}/armory/calibers`, {\n        method: 'GET'\n      }).then(response => {\n        response.json().then(response => {\n          let temp = [];\n          this.calibers = [];\n          if (response.length > 0) {\n            temp = response.slice(0, response.length);\n            for (let i = 0; i < temp.length; i++) {\n              this.calibers.push({\n                uuid: temp[i].uuid,\n                counter: '0',\n                unitPrice: temp[i].unitPrice,\n                unitPriceForNotMember: temp[i].unitPriceForNotMember,\n                name: temp[i].name,\n                quantity: temp[i].quantity\n              });\n            }\n          }\n        });\n      });\n    },\n    onInput(item, counter) {\n      const fe = this.calibers.find(function e(element) {\n        return element.uuid === item.uuid;\n      });\n      fe.counter = counter;\n      const fi = this.calibers.findIndex(function e(element) {\n        return element.uuid === item.uuid;\n      });\n      if (fe.counter >= 0) {\n        this.memberCostSum[fi] = fe.unitPrice * fe.counter;\n        this.notMemberCostSum[fi] = fe.unitPriceForNotMember * fe.counter;\n      }\n      this.calibers[fi] = fe;\n      this.counter = '';\n    },\n    viewCurrency(money) {\n      if (money === undefined) {\n        money = '0';\n      }\n      const formatterPL = new Intl.NumberFormat('pl-PL', {\n        style: 'currency',\n        currency: 'PLN'\n      });\n      const cash = formatterPL.format(money);\n      return cash;\n    },\n    mapCalibers(calibersObject) {\n      const map = new Map();\n      for (let i = 0; i < calibersObject.length; i++) {\n        if (calibersObject[i].counter !== '0' && calibersObject[i].counter !== '') {\n          map.set(calibersObject[i].uuid, Number(calibersObject[i].counter));\n        }\n      }\n      return map;\n    },\n    addMemberAndAmmoToCaliber(map) {\n      const memberNameWord = this.memberName.split(' ');\n      const legNumber = memberNameWord.length;\n      const memberNameUUID = memberNameWord[legNumber - 1];\n      const otherNameWord = this.otherName.split(' ');\n      const idNumber = otherNameWord.length;\n      const otherNameID = otherNameWord[idNumber - 1];\n      fetch(`http://${this.local}/ammoEvidence/listOfAmmo?legitimationNumber=${memberNameUUID}&otherID=${otherNameID}`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(Object.fromEntries(map))\n      }).then(response => {\n        if (response.status === 200) {\n          response.text().then(response => {\n            this.message = response;\n            this.success = true;\n            this.dis = false;\n            this.getListCalibers();\n            this.memberCostSum = [];\n            this.notMemberCostSum = [];\n            this.$emit('addMemberAndAmmoToCaliber');\n            this.autoClose();\n          });\n        } else {\n          response.text().then(response => {\n            this.message = response;\n            this.failure = true;\n            this.dis = false;\n            this.autoClose();\n          });\n        }\n      }).catch(() => {\n        this.message = 'coś jest nie tak';\n        this.failure = true;\n        this.dis = false;\n        this.autoClose();\n      });\n    },\n    filterFn(val, update) {\n      if (val === '') {\n        update(() => {\n          const needle = val.toLowerCase();\n          this.options = this.filters.filter(v => v.name.toLowerCase().indexOf(needle) > -1);\n        });\n        return;\n      }\n      update(() => {\n        const needle = val.toLowerCase();\n        this.options = this.filters.filter(v => v.name.toLowerCase().indexOf(needle) > -1);\n      });\n    },\n    filterOther(val, update) {\n      if (val === '') {\n        update(() => {\n          const needle = val.toLowerCase();\n          this.options1 = this.filtersOther.filter(v => v.toLowerCase().indexOf(needle) > -1);\n        });\n        return;\n      }\n      update(() => {\n        const needle = val.toLowerCase();\n        this.options1 = this.filtersOther.filter(v => v.toLowerCase().indexOf(needle) > -1);\n      });\n    },\n    autoClose() {\n      setTimeout(() => {\n        this.success = false;\n        this.failure = false;\n        this.message = null;\n        document.getElementById('1').close();\n      }, 2000);\n    }\n  }\n});\n// CONCATENATED MODULE: ./src/components/ammoList/AddAmmunition.vue?vue&type=script&lang=js&\n /* harmony default export */ var ammoList_AddAmmunitionvue_type_script_lang_js_ = (AddAmmunitionvue_type_script_lang_js_); \n// EXTERNAL MODULE: ./node_modules/vue-loader/lib/runtime/componentNormalizer.js\nvar componentNormalizer = __webpack_require__(\"2877\");\n\n// EXTERNAL MODULE: ./node_modules/quasar/src/components/select/QSelect.js + 1 modules\nvar QSelect = __webpack_require__(\"ddd8\");\n\n// EXTERNAL MODULE: ./node_modules/quasar/src/components/item/QItem.js\nvar QItem = __webpack_require__(\"66e5\");\n\n// EXTERNAL MODULE: ./node_modules/quasar/src/components/item/QItemSection.js\nvar QItemSection = __webpack_require__(\"4074\");\n\n// EXTERNAL MODULE: ./node_modules/quasar/src/components/input/QInput.js + 1 modules\nvar QInput = __webpack_require__(\"27f9\");\n\n// EXTERNAL MODULE: ./node_modules/quasar/src/components/card/QCardActions.js\nvar QCardActions = __webpack_require__(\"4b7e\");\n\n// EXTERNAL MODULE: ./node_modules/quasar/src/components/btn/QBtn.js\nvar QBtn = __webpack_require__(\"9c40\");\n\n// EXTERNAL MODULE: ./node_modules/quasar/src/components/dialog/QDialog.js\nvar QDialog = __webpack_require__(\"24e8\");\n\n// EXTERNAL MODULE: ./node_modules/quasar/src/components/card/QCard.js\nvar QCard = __webpack_require__(\"f09f\");\n\n// EXTERNAL MODULE: ./node_modules/quasar/src/components/card/QCardSection.js\nvar QCardSection = __webpack_require__(\"a370\");\n\n// EXTERNAL MODULE: ./node_modules/quasar/src/directives/ClosePopup.js\nvar ClosePopup = __webpack_require__(\"7f67\");\n\n// EXTERNAL MODULE: ./node_modules/@quasar/app/lib/webpack/runtime.auto-import.js\nvar runtime_auto_import = __webpack_require__(\"eebe\");\nvar runtime_auto_import_default = /*#__PURE__*/__webpack_require__.n(runtime_auto_import);\n\n// CONCATENATED MODULE: ./src/components/ammoList/AddAmmunition.vue\n\n\n\n\n\n/* normalize component */\n\nvar component = Object(componentNormalizer[\"a\" /* default */])(\n  ammoList_AddAmmunitionvue_type_script_lang_js_,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* harmony default export */ var AddAmmunition = __webpack_exports__[\"default\"] = (component.exports);\n\n\n\n\n\n\n\n\n\n\nruntime_auto_import_default()(component, 'components', {QSelect: QSelect[\"a\" /* default */],QItem: QItem[\"a\" /* default */],QItemSection: QItemSection[\"a\" /* default */],QInput: QInput[\"a\" /* default */],QCardActions: QCardActions[\"a\" /* default */],QBtn: QBtn[\"a\" /* default */],QDialog: QDialog[\"a\" /* default */],QCard: QCard[\"a\" /* default */],QCardSection: QCardSection[\"a\" /* default */]});runtime_auto_import_default()(component, 'directives', {ClosePopup: ClosePopup[\"a\" /* default */]});\n\n\n/***/ })\n\n}]);","inputSourceMap":null}